import{_ as i,o,c as t,ag as a}from"./chunks/framework.DM0yugQT.js";const m=JSON.parse('{"title":"Lane B Report: Quality/Governance + Docs-Code Parity (2026-02-23)","description":"","frontmatter":{},"headers":[],"relativePath":"planning/reports/lane-b-quality-governance-doc-parity-2026-02-23.md","filePath":"planning/reports/lane-b-quality-governance-doc-parity-2026-02-23.md","lastUpdated":1771824590000}'),r={name:"planning/reports/lane-b-quality-governance-doc-parity-2026-02-23.md"};function l(s,e,d,c,n,u){return o(),t("div",null,[...e[0]||(e[0]=[a('<h1 id="lane-b-report-quality-governance-docs-code-parity-2026-02-23" tabindex="-1">Lane B Report: Quality/Governance + Docs-Code Parity (2026-02-23) <a class="header-anchor" href="#lane-b-report-quality-governance-docs-code-parity-2026-02-23" aria-label="Permalink to &quot;Lane B Report: Quality/Governance + Docs-Code Parity (2026-02-23)&quot;">​</a></h1><h2 id="scope" tabindex="-1">Scope <a class="header-anchor" href="#scope" aria-label="Permalink to &quot;Scope&quot;">​</a></h2><p>Owner lane: CLIPROXYAPI-PLUSPLUS lane B in this worktree.</p><h2 id="task-completion-10-10" tabindex="-1">Task Completion (10/10) <a class="header-anchor" href="#task-completion-10-10" aria-label="Permalink to &quot;Task Completion (10/10)&quot;">​</a></h2><ol><li>Baseline quality commands run and failures collected.</li><li>Resolved deterministic quality failures in Go/docs surfaces.</li><li>Added stream/non-stream token usage parity test coverage.</li><li>Reconciled docs status drift for issue #258 in fragmented validation report.</li><li>Added automated regression guard and wired it into Taskfile.</li><li>Improved provider operations runbook with concrete verifiable parity commands.</li><li>Updated report text contains no stale pending markers.</li><li>Re-ran verification commands and captured pass/fail.</li><li>Listed unresolved blocked items needing larger refactor.</li><li>Produced lane report with changed files and command evidence.</li></ol><h2 id="baseline-and-immediate-failures" tabindex="-1">Baseline and Immediate Failures <a class="header-anchor" href="#baseline-and-immediate-failures" aria-label="Permalink to &quot;Baseline and Immediate Failures&quot;">​</a></h2><ul><li><code>task quality:quick</code> (initial baseline): progressed through fmt/lint/tests; later reruns exposed downstream provider-smoke script failure (see unresolved blockers).</li><li><code>go vet ./...</code>: pass.</li><li>Selected tests baseline: <code>go test ./pkg/llmproxy/runtime/executor ...</code> pass for targeted slices.</li></ul><p>Deterministic failures captured during this lane:</p><ul><li><code>go test ./pkg/llmproxy/runtime/executor -run &#39;TestParseOpenAIStreamUsageResponsesParity&#39; -count=1</code><ul><li>Fail before fix: <code>input tokens = 0, want 11</code>.</li></ul></li><li><code>./.github/scripts/check-open-items-fragmented-parity.sh</code><ul><li>Fail before doc reconciliation: <code>missing implemented status for #258</code>.</li></ul></li></ul><h2 id="fixes-applied" tabindex="-1">Fixes Applied <a class="header-anchor" href="#fixes-applied" aria-label="Permalink to &quot;Fixes Applied&quot;">​</a></h2><ul><li>Stream usage parser parity fix: <ul><li><code>pkg/llmproxy/runtime/executor/usage_helpers.go</code></li><li><code>parseOpenAIStreamUsage</code> now supports both <code>prompt/completion_tokens</code> and <code>input/output_tokens</code>, including cached/reasoning fallback fields.</li></ul></li><li>New parity/token tests: <ul><li><code>pkg/llmproxy/runtime/executor/usage_helpers_test.go</code></li><li><code>pkg/llmproxy/runtime/executor/codex_token_count_test.go</code></li></ul></li><li>Docs drift reconciliation for #258: <ul><li><code>docs/reports/fragemented/OPEN_ITEMS_VALIDATION_2026-02-22.md</code></li><li><code>docs/reports/fragemented/merged.md</code></li></ul></li><li>Automated drift guard: <ul><li><code>.github/scripts/check-open-items-fragmented-parity.sh</code></li><li>Task wiring in <code>Taskfile.yml</code> via <code>quality:docs-open-items-parity</code> and inclusion in <code>quality:release-lint</code>.</li></ul></li><li>Runbook update with concrete commands: <ul><li><code>docs/provider-operations.md</code> section <code>Stream/Non-Stream Usage Parity Check</code>.</li></ul></li></ul><h2 id="verification-rerun-post-fix" tabindex="-1">Verification Rerun (Post-Fix) <a class="header-anchor" href="#verification-rerun-post-fix" aria-label="Permalink to &quot;Verification Rerun (Post-Fix)&quot;">​</a></h2><p>Pass:</p><ul><li><code>go test ./pkg/llmproxy/runtime/executor -run &#39;TestParseOpenAIStreamUsageResponsesParity|TestCountCodexInputTokens_FunctionCall(OutputObjectIncluded|ArgumentsObjectIncluded)&#39; -count=1</code></li><li><code>go test ./pkg/llmproxy/runtime/executor -run &#39;TestParseOpenAI(StreamUsageResponsesParity|UsageResponses)|TestNormalizeCodexToolSchemas|TestCountCodexInputTokens_FunctionCall(OutputObjectIncluded|ArgumentsObjectIncluded)&#39; -count=1</code></li><li><code>go vet ./...</code></li><li><code>./.github/scripts/check-open-items-fragmented-parity.sh</code></li><li><code>task quality:release-lint</code></li></ul><p>Fail (known non-lane blocker):</p><ul><li><code>QUALITY_PACKAGES=&#39;./pkg/llmproxy/runtime/executor&#39; task quality:quick:check</code><ul><li>Fails in <code>test:provider-smoke-matrix:test</code></li><li>Error: <code>scripts/provider-smoke-matrix-test.sh: line 29: $3: unbound variable</code></li></ul></li></ul><h2 id="c4-rerun-evidence-2026-02-23-isolated-worktree" tabindex="-1">C4 Rerun Evidence (2026-02-23, isolated worktree) <a class="header-anchor" href="#c4-rerun-evidence-2026-02-23-isolated-worktree" aria-label="Permalink to &quot;C4 Rerun Evidence (2026-02-23, isolated worktree)&quot;">​</a></h2><ul><li>Command: <ul><li><code>./.github/scripts/check-open-items-fragmented-parity.sh</code></li><li>Output: <code>[OK] fragmented open-items report parity checks passed</code></li></ul></li><li>Command: <ul><li><code>./.github/scripts/tests/check-open-items-fragmented-parity-test.sh</code></li><li>Output includes: <ul><li><code>===== pass on resolved/shipped status =====</code></li><li><code>===== fail on partial/pending status =====</code></li><li><code>===== fail on unknown status mapping =====</code></li><li><code>[OK] check-open-items-fragmented-parity script test suite passed</code></li></ul></li></ul></li><li>Command: <ul><li><code>QUALITY_PACKAGES=&#39;./pkg/llmproxy/runtime/executor&#39; task quality:quick:check</code></li><li>Output includes: <ul><li><code>ok github.com/router-for-me/CLIProxyAPI/v6/pkg/llmproxy/runtime/executor</code></li><li><code>task: [test:provider-smoke-matrix:test] scripts/provider-smoke-matrix-test.sh</code></li><li><code>scripts/provider-smoke-matrix-test.sh: line 29: $3: unbound variable</code></li></ul></li><li>Retry policy: <ul><li>No lock-contention signature observed (<code>lock contention</code>, <code>already locked</code>, <code>resource busy</code>, <code>database is locked</code> were absent), so no rerun was performed.</li></ul></li></ul></li></ul><h2 id="unresolved-blocked-items-need-larger-refactor-separate-lane" tabindex="-1">Unresolved Blocked Items (Need Larger Refactor/Separate Lane) <a class="header-anchor" href="#unresolved-blocked-items-need-larger-refactor-separate-lane" aria-label="Permalink to &quot;Unresolved Blocked Items (Need Larger Refactor/Separate Lane)&quot;">​</a></h2><ol><li><code>scripts/provider-smoke-matrix-test.sh</code> negative-path harness has <code>set -u</code> positional arg bug (<code>$3</code> unbound) during <code>EXPECT_SUCCESS=0</code> scenario.</li><li><code>task quality:quick</code> currently depends on provider smoke matrix behavior outside this lane-B doc/token parity scope.</li></ol><h2 id="changed-files" tabindex="-1">Changed Files <a class="header-anchor" href="#changed-files" aria-label="Permalink to &quot;Changed Files&quot;">​</a></h2><ul><li><code>pkg/llmproxy/runtime/executor/usage_helpers.go</code></li><li><code>pkg/llmproxy/runtime/executor/usage_helpers_test.go</code></li><li><code>pkg/llmproxy/runtime/executor/codex_token_count_test.go</code></li><li><code>.github/scripts/check-open-items-fragmented-parity.sh</code></li><li><code>Taskfile.yml</code></li><li><code>docs/reports/fragemented/OPEN_ITEMS_VALIDATION_2026-02-22.md</code></li><li><code>docs/reports/fragemented/merged.md</code></li><li><code>docs/provider-operations.md</code></li><li><code>docs/planning/reports/lane-b-quality-governance-doc-parity-2026-02-23.md</code></li></ul><h2 id="c4-rerun-net-diff-this-worktree-pass" tabindex="-1">C4 Rerun Net Diff (This Worktree Pass) <a class="header-anchor" href="#c4-rerun-net-diff-this-worktree-pass" aria-label="Permalink to &quot;C4 Rerun Net Diff (This Worktree Pass)&quot;">​</a></h2><ul><li><code>.github/scripts/check-open-items-fragmented-parity.sh</code></li><li><code>.github/scripts/tests/check-open-items-fragmented-parity-test.sh</code></li><li><code>docs/planning/reports/lane-b-quality-governance-doc-parity-2026-02-23.md</code></li></ul>',24)])])}const h=i(r,[["render",l]]);export{m as __pageData,h as default};
