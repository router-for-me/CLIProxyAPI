import{_ as o,o as i,c as a,ag as t}from"./chunks/framework.DM0yugQT.js";const m=JSON.parse('{"title":"Coverage Gaps Report","description":"","frontmatter":{},"headers":[],"relativePath":"planning/coverage-gaps.md","filePath":"planning/coverage-gaps.md","lastUpdated":1771810871000}'),s={name:"planning/coverage-gaps.md"};function d(l,e,r,c,n,p){return i(),a("div",null,[...e[0]||(e[0]=[t('<h1 id="coverage-gaps-report" tabindex="-1">Coverage Gaps Report <a class="header-anchor" href="#coverage-gaps-report" aria-label="Permalink to &quot;Coverage Gaps Report&quot;">​</a></h1><p>Date: 2026-02-22</p><h2 id="current-snapshot" tabindex="-1">Current Snapshot <a class="header-anchor" href="#current-snapshot" aria-label="Permalink to &quot;Current Snapshot&quot;">​</a></h2><ul><li>Scope assessed: <ul><li><code>pkg/llmproxy/api</code>, <code>pkg/llmproxy/translator</code>, <code>sdk/api/handlers</code></li><li>selected quality commands in <code>Taskfile.yml</code></li></ul></li><li>Baseline commands executed: <ul><li><code>go test ./pkg/llmproxy/api -run &#39;TestServer_|TestResponsesWebSocketHandler_.*&#39;</code></li><li><code>go test ./pkg/llmproxy/api -run &#39;TestServer_ControlPlane_MessageLifecycle|TestServer_ControlPlane_UnsupportedCapability|TestServer_RoutesNamespaceIsolation|TestServer_ResponsesRouteSupportsHttpAndWebsocketShapes|TestServer_StartupSmokeEndpoints&#39;</code></li><li><code>QUALITY_PACKAGES=&#39;./pkg/llmproxy/api ./sdk/api/handlers/openai&#39; task quality:quick</code></li></ul></li><li><code>task quality:fmt:check</code></li><li><code>task lint:changed</code> (environment reports golangci-lint Go 1.25 binary mismatch with Go 1.26 target)</li><li><code>go test ./pkg/llmproxy/api -run &#39;TestServer_&#39;</code></li><li><code>go test ./sdk/api/handlers -run &#39;TestRequestExecutionMetadata&#39;</code></li><li><code>/.github/scripts/check-distributed-critical-paths.sh</code></li><li><code>QUALITY_PACKAGES=&#39;./pkg/llmproxy/api ./sdk/api/handlers/openai&#39; task quality:quick:check</code></li><li><code>task quality:quick:all</code> currently still needs sibling compatibility validation when golangci-lint is missing/heterogeneous across siblings.</li></ul><h2 id="gap-matrix" tabindex="-1">Gap Matrix <a class="header-anchor" href="#gap-matrix" aria-label="Permalink to &quot;Gap Matrix&quot;">​</a></h2><ul><li>Unit: <ul><li>Coverage improved for API route lifecycle and websocket idempotency.</li><li>Added startup smoke assertions for <code>/v1/models</code> and <code>/v1/metrics/providers</code>, plus repeated <code>setupRoutes</code> route-count stability checks.</li><li>Added <code>requestExecutionMetadata</code> regression tests (idempotency key propagation + session/auth metadata).</li><li>Added control-plane shell endpoint coverage for <code>/message</code>, <code>/messages</code>, <code>/status</code>, <code>/events</code> in <code>pkg/llmproxy/api/server_test.go</code>.</li><li>Added command-label translation tests for <code>/message</code> aliases (<code>ask</code>, <code>exec</code>, <code>max</code>, <code>continue</code>, <code>resume</code>).</li><li>Added <code>/message</code> idempotency replay test that asserts duplicate key reuse and no duplicate in-memory message append.</li><li>Added idempotency negative test for different <code>Idempotency-Key</code> values and in-flight message-copy isolation for <code>/messages</code>.</li><li>Added task-level quality gates (<code>quality:ci</code>, <code>lint:changed</code> with PR ranges, <code>test:smoke</code>) and workflow/required-check wiring for CI pre-merge gates.</li><li>Added <code>quality:release-lint</code> and required-check <code>quality-staged-check</code> in CI; added docs/code snippet parse coverage for release lint.</li><li>Added thinking validation coverage for level rebound and budget boundary clamping in <code>pkg/llmproxy/thinking/validate_test.go</code>: <ul><li>unsupported/rebound level handling and deterministic clamping to supported levels,</li><li>min/max/zero/negative budget normalization for non-strict suffix-paths,</li><li>explicit strict out-of-range rejection (<code>ErrBudgetOutOfRange</code>) when same-provider budget requests are too high.</li><li>auto-mode behavior for dynamic-capable vs non-dynamic models (<code>ModeAuto</code> midpoint fallback and preservation paths).</li></ul></li><li>Remaining: complete route-namespace matrix for command-label translation across orchestrator-facing surfaces beyond <code>/message</code>, and status/event replay windows.</li></ul></li><li>Integration: <ul><li>Added: <code>scripts/provider-smoke-matrix.sh</code> plus <code>task test:provider-smoke-matrix</code> for deterministic smoke checks against <code>/v1/responses</code> using provider-qualified aliases.</li><li>Added: <code>scripts/provider-smoke-matrix-cheapest.sh</code> and <code>task test:provider-smoke-matrix:cheapest</code> with deterministic cheapest-model coverage for six core providers.</li></ul></li><li>Added: required CI job <code>provider-smoke-matrix-cheapest</code> for live cheap-path smoke against six defaults. <ul><li>Remaining: end-to-end provider cheapest-path smoke for all provider auth modes in persistent CI defaults. Unit-level smoke now covers: <ul><li><code>/v1/models</code> namespace behavior for OpenAI-compatible and <code>claude-cli</code> User-Agent paths.</li><li><code>/v1/metrics/providers</code> response shape and metric-field assertions with seeded usage data.</li><li>control-plane lifecycle endpoints with idempotency replay windows.</li></ul></li><li>Remaining: live provider smoke and control-plane session continuity across process restarts.</li></ul></li><li>E2E: <ul><li>Remaining: end-to-end harness for <code>/agent/*</code> parity and full resume/continuation semantics.</li><li>Remaining: live-process orchestration for <code>/v1/models</code>, <code>/v1/metrics/providers</code>, and <code>/v1/responses</code> websocket fallback.</li><li>Added first smoke-level unit checks for <code>/message</code> lifecycle and <code>/v1</code> models/metrics namespace dispatch.</li></ul></li><li>Chaos: <ul><li>Remaining: websocket drop/reconnect and upstream timeout injection suite.</li></ul></li><li>Perf: <ul><li>Remaining: concurrent fanout/p99/p95 measurement for <code>/v1/responses</code> stream fanout.</li></ul></li><li>Security: <ul><li>Remaining: token leak and origin-header downgrade guard assertions.</li></ul></li><li>Docs:</li><li>Remaining: close loop on <code>docs/planning/README</code> command matrix references in onboarding guides and add explicit evidence links for the cheapest-provider matrix tasks.</li></ul><h2 id="close-out-owner" tabindex="-1">Close-out Owner <a class="header-anchor" href="#close-out-owner" aria-label="Permalink to &quot;Close-out Owner&quot;">​</a></h2><ul><li>Owner placeholder: <code>cliproxy</code> sprint lead</li><li>Required before lane closure: each unchecked item in this file must have evidence in <code>docs/planning/agents.md</code>.</li></ul>',8)])])}const g=o(s,[["render",d]]);export{m as __pageData,g as default};
