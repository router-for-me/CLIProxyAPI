import{_ as s,o as a,c as e,ag as t}from"./chunks/framework.DM0yugQT.js";const c=JSON.parse('{"title":"Provider Usage","description":"","frontmatter":{},"headers":[],"relativePath":"provider-usage.md","filePath":"provider-usage.md","lastUpdated":1771763743000}'),n={name:"provider-usage.md"};function l(r,i,p,o,h,d){return a(),e("div",null,[...i[0]||(i[0]=[t(`<h1 id="provider-usage" tabindex="-1">Provider Usage <a class="header-anchor" href="#provider-usage" aria-label="Permalink to &quot;Provider Usage&quot;">​</a></h1><p><code>cliproxyapi++</code> routes OpenAI-style requests to many provider backends through a unified auth and translation layer.</p><p>This page covers provider strategy and high-signal setup patterns. For full block-by-block coverage, use <a href="/provider-catalog">Provider Catalog</a>.</p><h2 id="audience-guidance" tabindex="-1">Audience Guidance <a class="header-anchor" href="#audience-guidance" aria-label="Permalink to &quot;Audience Guidance&quot;">​</a></h2><ul><li>Use this page if you manage provider credentials and model routing.</li><li>Use <a href="/routing-reference">Routing and Models Reference</a> for selection behavior details.</li><li>Use <a href="/troubleshooting">Troubleshooting</a> for runtime failure triage.</li></ul><h2 id="provider-categories" tabindex="-1">Provider Categories <a class="header-anchor" href="#provider-categories" aria-label="Permalink to &quot;Provider Categories&quot;">​</a></h2><ul><li>Direct APIs: Claude, Gemini, OpenAI, Mistral, Groq, DeepSeek.</li><li>Aggregators: OpenRouter, Together AI, Fireworks AI, Novita AI, SiliconFlow.</li><li>Proprietary/OAuth flows: Kiro, GitHub Copilot, Roo Code, Kilo AI, MiniMax.</li></ul><h2 id="naming-and-metadata-conventions" tabindex="-1">Naming and Metadata Conventions <a class="header-anchor" href="#naming-and-metadata-conventions" aria-label="Permalink to &quot;Naming and Metadata Conventions&quot;">​</a></h2><ul><li>Use canonical provider keys in config and ops docs (<code>github-copilot</code>, <code>antigravity</code>, <code>claude</code>, <code>codex</code>).</li><li>Keep user-facing aliases stable and provider-agnostic where possible (for example <code>claude-sonnet-4-6</code>), and map upstream-specific names through <code>oauth-model-alias</code>.</li><li>For GitHub Copilot, treat it as a distinct provider channel (<code>github-copilot</code>), not a generic &quot;microsoft account&quot; channel. Account eligibility still depends on Copilot plan entitlements.</li></ul><h2 id="provider-first-architecture" tabindex="-1">Provider-First Architecture <a class="header-anchor" href="#provider-first-architecture" aria-label="Permalink to &quot;Provider-First Architecture&quot;">​</a></h2><p><code>cliproxyapi++</code> keeps one client-facing API (<code>/v1/*</code>) and pushes provider complexity into configuration:</p><ol><li>Inbound auth is validated from top-level <code>api-keys</code>.</li><li>Model names are resolved by prefix + alias.</li><li>Routing selects provider/credential based on eligibility.</li><li>Upstream call is translated and normalized back to OpenAI-compatible output.</li></ol><p>This lets clients stay stable while provider strategy evolves independently.</p><h2 id="common-configuration-pattern" tabindex="-1">Common Configuration Pattern <a class="header-anchor" href="#common-configuration-pattern" aria-label="Permalink to &quot;Common Configuration Pattern&quot;">​</a></h2><p>Use provider-specific blocks in <code>config.yaml</code>:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Client API auth for /v1/*</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">api-keys</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;prod-client-key&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># One direct provider</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">claude-api-key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">api-key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sk-ant-xxxx&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    prefix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;claude-prod&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># One OpenAI-compatible aggregator</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">openai-compatibility</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;openrouter&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    prefix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;or&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    base-url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://openrouter.ai/api/v1&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    api-key-entries</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">api-key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sk-or-v1-xxxx&quot;</span></span></code></pre></div><h2 id="mlx-and-vllm-mlx-pattern" tabindex="-1">MLX and vLLM-MLX Pattern <a class="header-anchor" href="#mlx-and-vllm-mlx-pattern" aria-label="Permalink to &quot;MLX and vLLM-MLX Pattern&quot;">​</a></h2><p>For MLX servers that expose OpenAI-compatible APIs (for example <code>mlx-openai-server</code> and <code>vllm-mlx</code>), configure them under <code>openai-compatibility</code>:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">openai-compatibility</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mlx-local&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    prefix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mlx&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    base-url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://127.0.0.1:8000/v1&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    api-key-entries</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">api-key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dummy-or-local-key&quot;</span></span></code></pre></div><p>Then request models through the configured prefix (for example <code>mlx/&lt;model-id&gt;</code>), same as other OpenAI-compatible providers.</p><h2 id="requesting-models" tabindex="-1">Requesting Models <a class="header-anchor" href="#requesting-models" aria-label="Permalink to &quot;Requesting Models&quot;">​</a></h2><p>Call standard OpenAI-compatible endpoints:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sS</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> POST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:8317/v1/chat/completions</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Authorization: Bearer prod-client-key&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Content-Type: application/json&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;model&quot;: &quot;claude-prod/claude-3-5-sonnet&quot;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;messages&quot;: [{&quot;role&quot;:&quot;user&quot;,&quot;content&quot;:&quot;Summarize this repository&quot;}],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;stream&quot;: false</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  }&#39;</span></span></code></pre></div><p>Prefix behavior depends on your <code>prefix</code> + <code>force-model-prefix</code> settings.</p><h2 id="production-routing-pattern" tabindex="-1">Production Routing Pattern <a class="header-anchor" href="#production-routing-pattern" aria-label="Permalink to &quot;Production Routing Pattern&quot;">​</a></h2><p>Use this default design in production:</p><ul><li>Primary direct provider for predictable latency.</li><li>Secondary aggregator provider for breadth/failover.</li><li>Prefix isolation by workload (for example <code>agent-core/*</code>, <code>batch/*</code>).</li><li>Explicit alias map for client-stable model names.</li></ul><p>Example:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">force-model-prefix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">claude-api-key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">api-key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sk-ant-...&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    prefix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;agent-core&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    models</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;claude-3-5-sonnet-20241022&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        alias</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;core-sonnet&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">openrouter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">api-key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sk-or-v1-...&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    prefix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;batch&quot;</span></span></code></pre></div><h2 id="verify-active-model-inventory" tabindex="-1">Verify Active Model Inventory <a class="header-anchor" href="#verify-active-model-inventory" aria-label="Permalink to &quot;Verify Active Model Inventory&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:8317/v1/models</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Authorization: Bearer prod-client-key&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> jq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;.data[].id&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> head</span></span></code></pre></div><p>If a model is missing, verify provider block, credential validity, and prefix constraints.</p><h2 id="rotation-and-multi-credential-guidance" tabindex="-1">Rotation and Multi-Credential Guidance <a class="header-anchor" href="#rotation-and-multi-credential-guidance" aria-label="Permalink to &quot;Rotation and Multi-Credential Guidance&quot;">​</a></h2><ul><li>Add multiple keys per provider to improve resilience.</li><li>Use prefixes to isolate traffic by team or workload.</li><li>Monitor <code>429</code> patterns and redistribute traffic before hard outage.</li><li>Keep at least one fallback provider for every critical workload path.</li></ul><h2 id="failure-modes-and-fixes" tabindex="-1">Failure Modes and Fixes <a class="header-anchor" href="#failure-modes-and-fixes" aria-label="Permalink to &quot;Failure Modes and Fixes&quot;">​</a></h2><ul><li>Upstream <code>401/403</code>: provider key invalid or expired.</li><li>Frequent <code>429</code>: provider quota/rate limit pressure; add keys/providers.</li><li>Unexpected provider choice: model prefix mismatch or alias overlap.</li><li>Provider appears unhealthy: inspect operations endpoints and logs.</li></ul><h2 id="provider-quickstarts" tabindex="-1">Provider Quickstarts <a class="header-anchor" href="#provider-quickstarts" aria-label="Permalink to &quot;Provider Quickstarts&quot;">​</a></h2><p>Prefer the 5-minute reference flows in:</p><ul><li><a href="/provider-quickstarts">Provider Quickstarts</a></li><li><a href="/provider-catalog">Provider Catalog</a></li></ul><h2 id="related-docs" tabindex="-1">Related Docs <a class="header-anchor" href="#related-docs" aria-label="Permalink to &quot;Related Docs&quot;">​</a></h2><ul><li><a href="/provider-catalog">Provider Catalog</a></li><li><a href="/provider-operations">Provider Operations</a></li><li><a href="/routing-reference">Routing and Models Reference</a></li><li><a href="/api/openai-compatible">OpenAI-Compatible API</a></li><li><a href="/features/providers/USER">Features: Providers</a></li></ul>`,41)])])}const u=s(n,[["render",l]]);export{c as __pageData,u as default};
