# Lane 4 CP2K Evidence Report (2026-02-23)

Scope: `CP2K-0040`, `CP2K-0045`, `CP2K-0047`, `CP2K-0048`, `CP2K-0050`

## Status by Item

### CP2K-0040 (`issue#134`)
- Status: `done`
- Gap closed in this lane: added deterministic non-stream usage fallback test when payload reports `output_tokens: 0` but has `completion_tokens`.
- Files:
  - `pkg/llmproxy/runtime/executor/usage_helpers_test.go`
  - `pkg/llmproxy/executor/usage_helpers_test.go`
- Focused checks:
  - `go test usage_helpers.go usage_helpers_test.go -run 'TestParseOpenAI(Usage|StreamUsage)_PrefersCompletionTokensWhenOutputTokensZero|TestParseOpenAIResponsesUsageTotalFallback' -count=1`
  - `go test usage_helpers.go usage_helpers_test.go -run 'TestParseOpenAI(Usage|StreamUsage)_PrefersCompletionTokensWhenOutputTokensZero' -count=1`

### CP2K-0045 (`issue#125`)
- Status: `partial (code/test present; package-level validation blocked by unrelated compile drift)`
- Existing lane-owned coverage remains in tree:
  - `pkg/llmproxy/executor/antigravity_executor_error_test.go`
- Blocker evidence:
  - `go test ./pkg/llmproxy/executor -run 'TestAntigravityErrorMessage_(AddsLicenseHintForKnown403|NoHintForNon403)' -count=1`
  - Failure is unrelated compile drift in package test set (`gemini_cli_executor_model_test.go: undefined: normalizeGeminiCLIModel`).

### CP2K-0047 (`issue#118`)
- Status: `done (focused parity coverage expanded)`
- Gap closed in this lane: added explicit stream/non-stream parity tests for `output_tokens: 0` + `completion_tokens` fallback behavior.
- Files:
  - `pkg/llmproxy/runtime/executor/usage_helpers_test.go`
  - `pkg/llmproxy/executor/usage_helpers_test.go`
- Focused checks: same commands as `CP2K-0040`.

### CP2K-0048 (`issue#115`)
- Status: `done`
- Existing behavior validated for AWS access portal failure detection path.
- Files:
  - `pkg/llmproxy/cmd/kiro_login_test.go`
- Focused checks:
  - `go test ./pkg/llmproxy/cmd -run 'TestIsKiroAWSAccessPortalError' -count=1`

### CP2K-0050 (`issue#111`)
- Status: `done`
- Existing behavior validated for OAuth callback bind/access remediation (`--oauth-callback-port`).
- Files:
  - `sdk/auth/antigravity_error_test.go`
- Focused checks:
  - `go test ./sdk/auth -run 'TestFormatAntigravityCallbackServerError_(PortInUse|Permission)' -count=1`

## Commands Run (result summary)
- `go test ./pkg/llmproxy/cmd -run 'TestIsKiroAWSAccessPortalError' -count=1` -> `ok`
- `go test ./sdk/auth -run 'TestFormatAntigravityCallbackServerError_(PortInUse|Permission)' -count=1` -> `ok`
- `go test usage_helpers.go usage_helpers_test.go ...` (both executor trees) -> `ok`
- `go test ./pkg/llmproxy/executor -run 'TestAntigravityErrorMessage_(AddsLicenseHintForKnown403|NoHintForNon403)' -count=1` -> `FAIL` due unrelated package compile drift (`normalizeGeminiCLIModel` missing in gemini model test file).
